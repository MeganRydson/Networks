# Express and HTML

In this lab, you're going to setup the Express web application framework and get started writing HTML web pages.

Express is a key part of the nodejs ecosystem. It's primary job is to route requests coming from user's browsers to JavaScript code.
Our first routings will simply send back static HTML pages, but more complex applications use this routing behavior to implement
client-server interactions and application logic.

## Express Setup

Change to your `cms450` directory and make a new directory called `front_end`, which will hold all of the applications we'll develop
in this part of the class.

```
prompt$ cd ~/workspace/cms450
prompt$ mkdir front_end
prompt$ cd front_end
```

Make a directory named `hello_app` and `cd` into it:

```
prompt$ mkdir hello_app
prompt$ cd hello_app
```

Run `npm init` to create a basic node application. When the command executes it will prompt you to enter information about the app you're
creating. You can press `ENTER` to accept all the defaults **EXCEPT** the line that says

```
entry point (index.js)
```

Enter `app.js` for the entry point file, which will be the main Express application code.

When `init` finishes, install Express in your application with

```
prompt$ npm install express --save
```

## Hello, Express World

You are now ready to `touch app.js` and open it in the editor. Put the following code in and save the file:

```
const express = require('express')
const app = express()
const port = 3000

app.get('/', (req, res) => res.send('Hello World!'))

app.listen(port, () => console.log(`Listening on port ${port}!`))
```

This is JavaScript code. The first two lines import the `express` package and initialize it.

The third line sets the port number for the application. The port is like a listening point managed by the OS. Every application that
maintains network access must have a unique port number that it listens on. Most of the lower port numbers (below 1024) are reserved
by the OS and can't be used by user-level apps.

Many standard protocols have their own reserved port numbers. For example, HTTP servers traditionally listen on port 80 and
8080; SSH (secure shell for logging into a remote server) uses 22.

The fourth line is the most important. It creates a route that maps a URL (`/`) to a function. The `/` path is the root document of
a site, the path that is generated when you access the base URL of a site, such as `http://www.rollins.edu`.

The function is an anonymous declaration using `=>` notation. The variable `req` is automatically generated by Express and can contain
information about the request. `res` is automatically generated by Express to handle the response. The function code (on the right
side of the arrow) sends back the text string `Hello, World!`.

The final line actually creates the listening server on port 3000.

To run the app, use

```
prompt$ node app.js
```

Open another SSH terminal and type

```
prompt$ curl http://localhost:3000
```

You should see `Hello, World!` print on the terminal. `curl` is a command for generating HTTP requests. The URL specifies the target of
the request is the local machine at port 3000.

To view the app through your own web browser, open the container info page by right clicking (or CTRL + clicking on Mac) on your
container name in the left-hand file browser pane, then selecting Info. This will open a file with information on your workspace.
Toward the bottom, there will be a URL similar to

```
https://dmyers-dmyers184899.codeanyapp.com/
```

Click on your URL and the page should open in your browser.

Return to the terminal and terminate the app by pressing `CTRL + c`. As a general rule, don't leave an app running if you aren't
actively testing it.

## A Certain HTML Index

Create an HTML file using `touch index.html`, then open it. Put the following code in:

```
<!DOCTYPE html>

<!-- This is an HTML comment. -->

<html>
    
    <!-- The head block is for page meta-information -->
    <head>
        <title>This appears as the browser tab title.</title>
    </head>
    
    <!-- The body is the page's content -->
    <body>
        
        <!-- <h1> is the top-level heading tag -->
        <h1>
            Hello, World!
        </h1>
        
        <!-- The <p> tag creates a paragraph of text -->
        
        <!-- The browser relies on tags to specify formatting. -->
        <!-- Most whitespace is ignored. -->
        <p>
            This is a web page that I wrote.
            
            It's all about peace and love and good happiness stuff.
        </p>
        
    </body>
    
</html>
```

The page is organized as a combination of content and tags that tell the browser how to format the content. THe `<head>` section 
contains meta-information for the entire page and the `<body>` is the actual visible content. Tags are enclosed in angle brackets
and most tags have a closing counterpart prefixed with a `/`, for example `<body>` and `</body>`.

Update your `app.js` to serve the new index page:

```
const express = require('express');
const app = express();
const port = 3000;
var path = require('path');

app.get('/', (req, res) => res.sendFile(path.join(__dirname, '/index.html')));

app.listen(port, () => console.log(`Example app listening on port ${port}!`));
```

The updated `app.get` line sends `index.html` in response to a request for the root of the site, `/`. `path.join` creates
an absolute path to `index.html`'s location. Express does not allow relative paths to files.

Re-run your app with `node app.js` and reload the web page. You should see the content of the HTML file.

## Interior Decoration

Use `curl` to grab an image.
```
prompt$ curl -O https://upload.wikimedia.org/wikipedia/commons/0/0a/The_Great_Wave_off_Kanagawa.jpg
```

The `-O` flag saves the file locally.

Create a new directory called `public` and move the file there.

```
prompt$ mkdir public
prompt$ mv The_Great_Wave_off_Kanagawa.jpg public
```

Add one more line to app.js, right after the `var path...` line:

```
app.use(express.static('public'))
```

This command allows Express to serve static assets (like images) out of the `public` directory.

Open your `index.html` file and add an image tag to its body.

```
<p>
    <img src="The_Great_Wave_off_Kanagawa.jpg"/>
</p>
```

Reload the page and check out your picture.

Yikes. That's large. You can add style to the tag to scale the image to a percentage of the display width:

```
<p>
    <img src="The_Great_Wave_off_Kanagawa.jpg" style="width:50%"/>
</p>
```

You can also set an absolute size in pixels, e.g. `"width:200px"`.

Styling elements by editing their tags was common in the old-school web, but modern practice favors separating page content from styling.
Create a `<style>` setion within the `<head>` block of your page:

```
<head>
    <title>This appears at the top of the browser.</title>

    <style>
        img {
            width: 50%;
        }
    </style>
</head>
```

The style rule specifies that the contents of all `<img>` tags should have their width set to 50% of the page size. You can 
remove the `style` declaration from the `<img>` tag and the picture will still be scaled to 50% of the page width.

You can add elements to the style block to control the presentation of other parts of the page. For example, to style the contents of  the entire body:

```
<head>
    <title>This appears at the top of the browser.</title>

    <style>
        img {
            width: 200px;
        }

        body {
            font-family: "Helvetica", "Arial", sans-serif;
            font-size: 18pt;
            background-color: #FAFAFA;
        }
    </style>
</head>
```

The `font-family` parameter takes a list of fonts and uses the first one that's available on the system, with the last choice
being the default system sans-serif font.

Colors are specified as three hex values, denoting the R, G, and B components of the color. Play around with some color parameters
and see what you can generate. You can also set `color` to control the color of the text.

Here's one last style block that makes things a little more readable by bringing the page contents to the center.

```
<style>
    img {
        width: 100%;
    }

    body {
        font-family: "Helvetica", "Arial", sans-serif;
        font-size: 18pt;
        color: #333333;
        background-color: #FCFCFC;
        margin: 40px auto;
        max-width: 640px;
    }
</style>
```

`max-width` controls the size of the display region in the browser. `margin` sets a padding of 40px around all sides of the page
content; `auto` centers the display region inside the browser frame, pulling everything to the middle. Note that this is centering the display region, not the content itself. The background and text are softened a little away from strict white and black.

## The Sloth. The Answer is the Sloth

If you have time remaining, jam out by creating a web page for your favorite animal.

Pull some pictures using `curl` and move them to the `public` directory. You can create second and third level headings using
`<h2>` and `<h3>` tags.

If you want to create lists of why your favorite animal is awesome, you can use `<ul>` to declare a bulleted ("unordered") list and
`<li>` for list items:

```
<h3> Reasons Sloths Are Awesome!!!1!! </h3>

<ul>
    <li> They can move three times faster in water than they do on land!
    <li> Algae gives their fur a spectacular green color!
    <li> Sloth babies are born while the mother is hanging in a tree!
</ul>
```
